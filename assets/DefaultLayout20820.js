import{_ as V,b as _,e as g,d as z,o as A,J as K,m,u as F,D as M,c as D,K as W,L as Q,r as d,g as o,f as n,w as v,v as k,B as S,h as $,n as R,z as X,a as Z,l as ee,x as N,i as B}from"../index20820.js";import{u as te}from"./sidebar20820.js";import{u as j}from"./user20820.js";import{c as oe,a as se,F as le}from"./vee-validate.esm20820.js";import{I as ne}from"./InputTextWithValidation20820.js";import{s as I}from"./toast20820.js";const ie="/assets/tandu_logo_leaf20820.jpeg",ae={},re={src:ie,alt:"Logo"};function ce(s,t){return _(),g("img",re)}const de=V(ae,[["render",ce]]),ue=z({setup(){A(()=>{w(),window.addEventListener("scroll",C)}),K(()=>{window.removeEventListener("scroll",C)});const s=m(),t=F(),a=m(),e=m(),f=m(),b=m(),u=M(),r=m(!1),c=m([{label:"Dashboard",icon:"pi pi-th-large",to:"/"},{label:"Polizze",icon:"pi pi-file",items:[{label:"Partner",to:"/polizze-partner"},{label:"Tutte le polizze",to:"/"}]},{label:"Estratto conto",icon:"pi pi-chart-line",to:"/estratto-conto"},{label:"Pagamenti",icon:"pi pi-wallet",to:"/pagamenti"},{label:"Repository",icon:"pi pi-folder",to:"/repository"}]),i=D(()=>t.isUserSuperAdmin),l=D(()=>t.currentUser),h=D(()=>t.loggedIn),x=function(y){f.value.toggle(y)},L=function(){t.logout()},w=function(){if(l.value&&l.value.full_name){var y=l.value.full_name.split(" ");y.length>1?e.value=y[0].charAt(0)+y[1].charAt(0):e.value=l.value.full_name.charAt(0)}},C=function(){r.value=window.scrollY>0};return W(u,()=>{w()}),Q(async()=>{}),{selectedCountry:s,items:c,menu:a,initials:e,op:f,showSelectCountry:b,isScrolled:r,route:u,isSuperAdmin:i,currentUser:l,loggedIn:h,toggle:x,logout:L}},components:{LogoTopbar:de}});const me={class:"container flex py-2"},_e={class:"col-10 flex align-items-center p-0"},pe={class:"col-2 flex justify-content-end m-0 px-0"},fe=o("i",{class:"pi pi-user mr-2"},null,-1),ve=o("i",{class:"pi pi-users mr-2"},null,-1),ge=o("i",{class:"pi pi-cog mr-2"},null,-1),be=o("i",{class:"pi pi-sign-out mr-2"},null,-1),he=o("div",null,null,-1);function ye(s,t,a,e,f,b){const u=d("LogoTopbar"),r=d("router-link"),c=d("Menubar"),i=d("Avatar"),l=d("OverlayPanel");return _(),g("div",{class:R(["topbar",{scrolled:s.isScrolled}])},[o("div",me,[o("div",_e,[n(r,{to:"/",class:"mr-6"},{default:v(()=>[n(u,{class:"h-2rem"})]),_:1}),n(c,{model:s.items,class:"mr-2 py-0"},null,8,["model"])]),o("div",pe,[s.currentUser?(_(),g("div",{key:0,class:"flex ml-2 text-color align-items-center cursor-pointer",onClick:t[0]||(t[0]=(...h)=>s.toggle&&s.toggle(...h))},[s.initials?(_(),k(i,{key:0,shape:"circle",label:s.initials},null,8,["label"])):(_(),k(i,{key:1,shape:"circle",icon:"pi pi-user"}))])):S("",!0),n(l,{ref:"op"},{default:v(()=>[o("p",null,[n(r,{to:"/"},{default:v(()=>[fe,$("Account")]),_:1})]),o("p",null,[n(r,{to:"/utenti"},{default:v(()=>[ve,$("Operatori e partner")]),_:1})]),o("p",null,[n(r,{to:"/"},{default:v(()=>[ge,$("Impostazioni")]),_:1})]),o("p",{onClick:t[1]||(t[1]=(...h)=>s.logout&&s.logout(...h))},[be,$("Logout")])]),_:1},512)])]),he],2)}const De=V(ue,[["render",ye]]),E=X({id:"dynamicDialog",state:()=>({_showDynamicDialog:!1,_title:"",_btnYesLabel:"",_btnNoLabel:"",_message:""}),getters:{showDynamicDialog:s=>s._showDynamicDialog,title:s=>s._title},actions:{setDynamicDialogVisibility(s){this.updateDynamicDialog(s)},updateDynamicDialog(s){this._showDynamicDialog=s,s||this.clearDynamicDialog()},setDialog(s,t,a,e){this._title=s,this._btnNoLabel=a,this._btnYesLabel=t,this._message=e},clearDynamicDialog(){}}}),Se={props:["user_id","detail"],setup(s){A(()=>{s.user_id&&y(s.user_id)});const t=m(""),a=m([{label:""}]),e=m({}),f=m([{name:"Attivo",value:!0},{name:"Disattivo",value:!1}]),b=m([{name:"Silver",value:"SILVER"},{name:"Gold",value:"GOLD"}]),u=m([{name:"Utente",value:"user"},{name:"Admin",value:"admin"}]),r=m(),c=m(!1);M();const i=Z(),l=j(),h=E(),x=m(!1),L=oe({company:se().required()}),w=D(()=>l.getCurrentUser),C=D(()=>l.allUsers),y=async function(p){l.fetchUserDetail(p).then(()=>{G()}).catch(U=>{})},O=async function(p){const U=new Map;await l.fetchAllUsers(U).catch(J=>{})},P=async function(){const U={user:Object.assign({},e.value)};l.updateUser(U).then(()=>{y(w.value.id+""),I(i,{message:"Utente aggiornato correttamente",title:""})}).catch(J=>{})},Y=async function(){const p={user:e.value};l.createUser(p).then(()=>{y(w.value.id+""),I(i,{message:"Utente creato correttamente.",title:""}),ee.push({name:"user-detail",params:{id:w.value.id}})}).catch(U=>{})},G=function(){e.value=Object.assign({},w.value)},H=function(){T(e.value.company_name),T(e.value.role)},q=function(){if(c.value=!0,H(),x.value){I(i,{message:"Controlla di aver inserito i campi obbligatori.",title:"",error:!0});return}t.value!=""||e.value.id?P():Y(),c.value=!1},T=function(p){if(c.value)return p==""||p==null?x.value=!0:x.value=!1,x.value};return{items:a,tmp_user:e,filteredUsers:r,allUsers:C,user_status:f,rankings:b,roles:u,schema:L,saveUser:q,validateField:T,fetchAllUsers:O,onSubmit:async function(p,U){},save:async function(){var p;(p=document.getElementById("btn-submit"))==null||p.click()},sendCredentials:function(){let p="Sei sicuro di voler inviare le credenziali a <b> "+e.value.full_name+"</b> ?";h.setDialog("Invia credenziali","Invia credenziali","Annulla",p),h.setDynamicDialogVisibility(!0)}}},components:{InputTextWithValidation:ne,Form:le}};const we={key:0,class:"flex align-items-center justify-content-end toolbar"},Ve={class:"user"},xe={class:"formgrid grid mt-3"},Ue={class:"col-12 pl-0"},ke={class:"flex align-items-center"},Ce=o("div",{class:"col-1"},[o("i",{class:"mt-1 pi pi-user"})],-1),$e={class:"field col-11"},Le=o("label",{for:"name"},"Nome",-1),Te={class:"flex align-items-center"},Ie=o("div",{class:"col-1"},null,-1),ze={class:"field col-11"},Ae=o("label",{for:"last_name"},"Cognome",-1),Be={class:"flex align-items-center"},Ee=o("div",{class:"col-1"},[o("i",{class:"mt-1 pi pi-envelope"})],-1),Fe={class:"field col-11"},Me=o("label",{for:"email"},"Email",-1),Re={class:"flex align-items-center"},Ne=o("div",{class:"col-1"},[o("i",{class:"mt-1 pi pi-phone"})],-1),je={class:"field col-11"},Oe=o("label",{for:"phone"},"Phone",-1),Pe={class:"formgrid grid mt-3"},Ye={class:"col-12 pl-0"},Ge={class:"flex align-items-center"},He=o("div",{class:"col-1"},null,-1),qe={class:"field col-11 flex flex-column"},Je=o("label",{for:"name"},"Ruolo",-1),Ke={class:"flex align-items-center"},We=o("div",{class:"col-1"},null,-1),Qe={class:"field col-11 flex flex-column"},Xe=o("label",{for:"name"},"Stato",-1);function Ze(s,t,a,e,f,b){const u=d("Button"),r=d("InputText"),c=d("Dropdown"),i=d("Form");return _(),g(N,null,[e.tmp_user.id?(_(),g("div",we,[o("div",null,[n(u,{label:"Invia credenziali",outlined:"",rounded:"",size:"small",onClick:t[0]||(t[0]=l=>e.sendCredentials())})])])):S("",!0),o("div",Ve,[e.tmp_user?(_(),k(i,{key:0,"validation-schema":e.schema,onSubmit:e.onSubmit,class:"flex flex-column"},{default:v(()=>[o("div",xe,[o("div",Ue,[o("div",ke,[Ce,o("div",$e,[Le,n(r,{id:"name",type:"text",modelValue:e.tmp_user.first_name,"onUpdate:modelValue":t[1]||(t[1]=l=>e.tmp_user.first_name=l),class:"w-full",placeholder:a.detail?"-":""},null,8,["modelValue","placeholder"])])]),o("div",Te,[Ie,o("div",ze,[Ae,n(r,{id:"last_name",type:"text",modelValue:e.tmp_user.last_name,"onUpdate:modelValue":t[2]||(t[2]=l=>e.tmp_user.last_name=l),class:"w-full",placeholder:a.detail?"-":""},null,8,["modelValue","placeholder"])])]),o("div",Be,[Ee,o("div",Fe,[Me,n(r,{id:"email",type:"text",modelValue:e.tmp_user.email,"onUpdate:modelValue":t[3]||(t[3]=l=>e.tmp_user.email=l),class:"w-full",placeholder:a.detail?"-":""},null,8,["modelValue","placeholder"])])]),o("div",Re,[Ne,o("div",je,[Oe,n(r,{id:"phone",type:"text",modelValue:e.tmp_user.phone,"onUpdate:modelValue":t[4]||(t[4]=l=>e.tmp_user.phone=l),class:"w-full",placeholder:a.detail?"-":""},null,8,["modelValue","placeholder"])])])])]),o("div",Pe,[o("div",Ye,[o("div",Ge,[He,o("div",qe,[Je,n(c,{modelValue:e.tmp_user.role,"onUpdate:modelValue":t[5]||(t[5]=l=>e.tmp_user.role=l),options:e.roles,optionLabel:"name",optionValue:"value",placeholder:a.detail?"-":"",class:"w-full"},null,8,["modelValue","options","placeholder"])])]),o("div",Ke,[We,o("div",Qe,[Xe,n(c,{modelValue:e.tmp_user.enabled,"onUpdate:modelValue":t[6]||(t[6]=l=>e.tmp_user.enabled=l),options:e.user_status,optionLabel:"name",optionValue:"value",placeholder:a.detail?"-":"",class:"w-full"},null,8,["modelValue","options","placeholder"])])])])]),n(u,{type:"submit",class:"hidden",id:"btn-submit"})]),_:1},8,["validation-schema","onSubmit"])):S("",!0)])],64)}const et=V(Se,[["render",Ze]]),tt={props:["type"],setup(){const s=m();m();const t=te(),a=E(),e=j(),f=D(()=>t.showSidebar);return D(()=>e.getCurrentUser),{showSidebar:f,sidebarStore:t,userDetailView:s,toggleEdit:function(i){t.setShowDetail(i)},closeSidebar:function(){t.updateSidebar(!1)},saveData:function(){s.value.save()},confirmDelete:function(){let i="Sei sicuro di voler eliminare?";a.setDialog("Elimina","Elimina","Annulla",i),a.setDynamicDialogVisibility(!0)}}},components:{UserDetailView:et}},ot={class:"flex align-items-center justify-content-between"},st={class:"m-0"},lt={key:0,class:"flex align-items-center"},nt=o("span",{class:"pi pi-pencil"},null,-1),it=[nt],at=o("span",{class:"pi pi-trash"},null,-1),rt=[at],ct=o("span",{class:"pi pi-times"},null,-1),dt=[ct],ut={key:1,class:"flex align-items-center"};function mt(s,t,a,e,f,b){const u=d("Button"),r=d("UserDetailView"),c=d("Sidebar");return _(),k(c,{visible:e.showSidebar,"onUpdate:visible":t[5]||(t[5]=i=>e.showSidebar=i),position:"right",class:"w-full md:w-20rem lg:w-30rem",showCloseIcon:!1,dismissable:!0},{header:v(()=>[o("div",ot,[o("h2",st,B(e.sidebarStore.title),1),e.sidebarStore.showDetail?(_(),g("div",ut,[n(u,{label:"Annulla",text:"",rounded:"",class:"mr-3",size:"small",onClick:t[3]||(t[3]=i=>e.toggleEdit(!1))}),n(u,{label:"Salva",outlined:"",rounded:"",size:"small",onClick:t[4]||(t[4]=i=>e.saveData())})])):(_(),g("div",lt,[e.sidebarStore.showDetail?S("",!0):(_(),g("button",{key:0,class:"p-sidebar-icon p-link mr-2",onClick:t[0]||(t[0]=i=>e.toggleEdit(!0))},it)),e.sidebarStore.showDetail?S("",!0):(_(),g("button",{key:1,class:"p-sidebar-icon p-link mr-2",onClick:t[1]||(t[1]=i=>e.confirmDelete())},rt)),o("button",{class:"p-sidebar-icon p-link mr-2",onClick:t[2]||(t[2]=i=>e.closeSidebar())},dt)]))])]),default:v(()=>[e.sidebarStore.detailType=="user"?(_(),k(r,{key:0,user_id:e.sidebarStore.typeId,class:R({detail:!e.sidebarStore.showDetail}),detail:!e.sidebarStore.showDetail,ref:"userDetailView"},null,8,["user_id","class","detail"])):S("",!0)]),_:1},8,["visible"])}const _t=V(tt,[["render",mt]]),pt=z({setup(){A(()=>{t.value="0.0.44"});const s=F(),t=m();return{loggedIn:D(()=>s.loggedIn),appVersion:t}}}),ft={key:0,class:"footer py-1 px-3 text-right"};function vt(s,t,a,e,f,b){return s.loggedIn?(_(),g("div",ft," v."+B(s.appVersion),1)):S("",!0)}const gt=V(pt,[["render",vt]]),bt={setup(){const s=E();return{visible:D(()=>s.showDynamicDialog),toggleVisibility:function(e){s.setDynamicDialogVisibility(e)},dynamicDialogStore:s}}};const ht={class:"flex justify-content-between align-items-center w-full"},yt={class:"m-0"},Dt=["innerHTML"];function St(s,t,a,e,f,b){const u=d("Button"),r=d("Dialog");return e.dynamicDialogStore?(_(),k(r,{key:0,visible:e.visible,"onUpdate:visible":t[3]||(t[3]=c=>e.visible=c),modal:"",header:e.dynamicDialogStore._title,closable:!1,style:{width:"30vw"},class:"custom-dialog"},{header:v(()=>[o("div",ht,[o("h2",yt,B(e.dynamicDialogStore._title),1),n(u,{rounded:"",icon:"pi pi-times",onClick:t[0]||(t[0]=c=>e.toggleVisibility(!1)),text:""})])]),footer:v(()=>[n(u,{label:e.dynamicDialogStore._btnNoLabel,onClick:t[1]||(t[1]=c=>e.toggleVisibility(!1)),outlined:"",rounded:"",size:"small"},null,8,["label"]),n(u,{label:e.dynamicDialogStore._btnYesLabel,onClick:t[2]||(t[2]=c=>e.visible=!1),autofocus:"",outlined:"",rounded:"",size:"small"},null,8,["label"])]),default:v(()=>[o("div",{innerHTML:e.dynamicDialogStore._message,class:"mt-3"},null,8,Dt)]),_:1},8,["visible","header"])):S("",!0)}const wt=V(bt,[["render",St]]),Vt=z({setup(){},components:{TopbarMenu:De,RightSidebar:_t,Footer:gt,DynamicDialog:wt}});const xt={class:"flex"},Ut={class:"col-12 p-0"},kt={class:"w-full wrapper-content pb-6"},Ct={class:"min-h-full pt-0 container pt-3"};function $t(s,t,a,e,f,b){const u=d("TopbarMenu"),r=d("RouterView"),c=d("RightSidebar"),i=d("Toast"),l=d("Footer"),h=d("DynamicDialog");return _(),g(N,null,[o("div",xt,[o("div",Ut,[n(u),o("div",kt,[o("div",Ct,[n(r),n(c)])])]),n(i,{position:"top-right"})]),n(l),n(h)],64)}const Rt=V(Vt,[["render",$t]]);export{Rt as default};
