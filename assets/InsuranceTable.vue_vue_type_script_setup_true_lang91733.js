import{d as G,s as M,_ as S,a9 as H,E as d,K as o,u as s,ac as J,o as m,b as i,a as u,f as l,F as x,t as y,e as _,O as W,M as X,y as Y,a3 as Z}from"../index91733.js";import{s as ee}from"./index91733.js";import{b as ae}from"./index917332.js";import{b as te}from"./index917333.js";import{u as oe,a as se,b as T,g as le,p as b,_ as V}from"./InsuranceStatusCircularIcon.vue_vue_type_script_setup_true_lang91733.js";import{u as ne,T as f,L as re}from"./LazyDataTable91733.js";import{u as ie}from"./useRole91733.js";import{u as ue}from"./partner91733.js";const ce={class:"flex items-center gap-x-2"},pe={class:"flex items-center gap-x-2"},de={class:"flex items-center gap-x-2"},me={class:"flex items-center min-h-[50px]"},fe={class:"pl-[85px]"},ve={class:"flex items-center justify-center"},z=10,Fe=G({__name:"InsuranceTable",props:{partnerId:{}},setup($){const w=$,U=J(),{isAdmin:C}=ie(),F=oe(),k=ue(),{allPartners:L}=M(k),{insurances:P,totalInsurances:N}=M(F),{onSort:D,onPage:E,loadLazyData:K,isLoading:O,onFilter:R}=ne({rows:z},Q),c=S(!1),v=S({id:{value:"",matchMode:f.EQ},partner_id:{value:"",matchMode:f.EQ},typology:{value:"",matchMode:f.LIKE},number:{value:"",matchMode:f.LIKE},status:{value:"",matchMode:f.EQ}});function I(){R(v.value)}const B=function(r){return{path:`${U.path}/${r}`}};async function Q(r){try{await F.fetchInsurances(r)}catch(n){console.error(n)}}async function j(){try{c.value=!0,await k.fetchPartners()}catch(r){console.error(r)}finally{c.value=!1}}return H(()=>{w.partnerId?(v.value.partner_id.value=w.partnerId,I()):K(),C.value&&j()}),(r,n)=>{const g=te,h=Y,p=ae,A=ee,q=Z;return m(),d(re,{value:s(P),rows:z,"total-records":s(N),onSort:s(D),onPage:s(E),onFilter:I,filters:v.value,"onUpdate:filters":n[0]||(n[0]=e=>v.value=e),"data-key":"id",scrollable:"",loading:s(O)},{empty:o(()=>n[2]||(n[2]=[i("Non ci sono polizze")])),default:o(()=>[w.partnerId?_("",!0):(m(),d(p,{key:0,class:"min-w-[150px]",header:"Partner",field:"partner_id",showFilterMatchModes:!1,showFilterOperator:!1,showFilterMenu:!1,"show-clear-button":!1},{filter:o(({filterModel:e,filterCallback:t})=>[u("div",ce,[l(g,{class:"w-[150px]",modelValue:e.value,"onUpdate:modelValue":[a=>e.value=a,t],options:s(L),"option-label":"name","option-value":"id",loading:c.value},{empty:o(()=>n[1]||(n[1]=[i("Non ci sono polizze")])),_:2},1032,["modelValue","onUpdate:modelValue","options","loading"]),l(h,{class:x(e.value?"":"invisible"),icon:"pi pi-filter-slash",variant:"text",rounded:"",onClick:a=>{e.value="",t()}},null,8,["class","onClick"])])]),body:o(({data:e})=>{var t;return[i(y((t=e.partner)==null?void 0:t.name),1)]}),_:1})),l(p,{style:{"min-width":"280px"},header:"Numero",field:"number",showFilterMatchModes:!1,showFilterOperator:!1,showFilterMenu:!1,"show-clear-button":!1},{filter:o(({filterModel:e,filterCallback:t})=>[l(A,{modelValue:e.value,"onUpdate:modelValue":a=>e.value=a,type:"text",placeholder:"Filtra",onKeydown:W(a=>t(),["enter"])},null,8,["modelValue","onUpdate:modelValue","onKeydown"])]),_:1}),l(p,{field:"typology",class:"min-w-[200px]",header:"Tipologia",showFilterMatchModes:!1,showFilterOperator:!1,showFilterMenu:!1,"show-clear-button":!1},{filter:o(({filterModel:e,filterCallback:t})=>[u("div",pe,[l(g,{class:"w-[150px]",modelValue:e.value,"onUpdate:modelValue":[a=>e.value=a,t],options:s(se)(),"option-label":a=>s(T)(a),loading:c.value},null,8,["modelValue","onUpdate:modelValue","options","option-label","loading"]),l(h,{class:x(e.value?"":"invisible"),icon:"pi pi-filter-slash",variant:"text",rounded:"",onClick:a=>{e.value="",t()}},null,8,["class","onClick"])])]),body:o(({data:e})=>[i(y(e.typology?s(T)(e.typology):""),1)]),_:1}),l(p,{field:"status",class:"min-w-[200px]",header:"Status",showFilterMatchModes:!1,showFilterOperator:!1,showFilterMenu:!1,"show-clear-button":!1},{filter:o(({filterModel:e,filterCallback:t})=>[u("div",de,[l(g,{class:"w-[200px]",modelValue:e.value,"onUpdate:modelValue":[a=>e.value=a,t],options:s(le)(),"option-label":a=>s(b)(a),loading:c.value},{value:o(({value:a})=>[u("div",me,[a?(m(),d(V,{key:0,class:"mr-4 flex-shrink-0",status:a},null,8,["status"])):_("",!0),i(" "+y(s(b)(a)),1)])]),option:o(({option:a})=>[a?(m(),d(V,{key:0,class:"mr-4",status:a},null,8,["status"])):_("",!0),i(" "+y(s(b)(a)),1)]),_:2},1032,["modelValue","onUpdate:modelValue","options","option-label","loading"]),l(h,{class:x(e.value?"":"invisible"),icon:"pi pi-filter-slash",variant:"text",rounded:"",onClick:a=>{e.value="",t()}},null,8,["class","onClick"])])]),body:o(({data:e})=>[u("div",fe,[e.status?(m(),d(V,{key:0,status:e.status},null,8,["status"])):_("",!0)])]),_:1}),l(p,{class:"w-[50px]","align-frozen":"right",frozen:""},{body:o(({data:e})=>[u("div",ve,[X(l(h,{type:"button","aria-haspopup":"true","aria-controls":"overlay_menu",icon:"pi pi-arrow-right",text:"",rounded:"",as:"router-link",to:B(e.id)},null,8,["to"]),[[q,"Modifica",void 0,{top:!0}]])])]),_:1})]),_:1},8,["value","total-records","onSort","onPage","filters","loading"])}}});export{Fe as _};
