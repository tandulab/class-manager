import{d as D,a1 as F,o as l,E as f,K as v,b as k,f as o,u as i,s as E,_ as h,a7 as $,a9 as B,aa as O,c as _,a as m,t as P,e as p,T as j,a8 as M,aj as w,ab as C,y as L,a0 as q}from"../index91733.js";import{u as K}from"./partner91733.js";import{V as c,a as G,c as H,b as J}from"./index.esm91733.js";import{s as Q}from"./confirm-dialog91733.js";import{I as N,C as U}from"./InjectionKeys91733.js";import"./index91733.js";import"./index917335.js";const W=D({__name:"PartnerDataCard",setup(x){const e=F(N.FORM_VALIDATION);return(d,s)=>{const r=G;return l(),f(U,null,{title:v(()=>s[0]||(s[0]=[k("Dati ")])),content:v(()=>[o(r,{class:"fluid-form-grid sm:grid-cols-3"},{default:v(()=>[o(c,{id:"name",name:"name",type:"text",label:"Nome*",detailMode:i(e)},null,8,["detailMode"]),o(c,{id:"vat",name:"vat",type:"text",label:"I.V.A",detailMode:i(e)},null,8,["detailMode"]),o(c,{id:"address",name:"address",type:"text",label:"Indirizzo",detailMode:i(e)},null,8,["detailMode"]),o(c,{id:"city",name:"city",type:"text",label:"Città",detailMode:i(e)},null,8,["detailMode"]),o(c,{id:"zip_code",name:"zip_code",type:"text",label:"CAP",detailMode:i(e)},null,8,["detailMode"]),o(c,{id:"province",name:"province",type:"text",label:"Provincia",detailMode:i(e)},null,8,["detailMode"])]),_:1})]),_:1})}}}),X={class:"flex flex-col sm:flex-row items-start sm:items-center justify-between mb-4"},Y={class:"flex items-center gap-4"},Z={key:0},ee={class:"flex flex-row items-stretch gap-2"},te={key:0,class:"flex flex-row items-stretch gap-4"},ae=D({__name:"PartnerDetailView",props:{id:{}},setup(x){const e=x,d=K(),{currentPartner:s}=E(d),r=h(!1),u=h(!!e.id),{resetForm:T,handleSubmit:V}=$({validationSchema:H({name:J().required("Nome è obbligatorio")})});async function I(a){try{r.value=!0,await d.fetchPartnerDetail(a),T({values:{...s.value}}),r.value=!1}catch(t){console.error(t)}}async function z(a){try{await d.deletePartner(a),await w.replace({name:C.PARTNER})}catch(t){console.error(t)}}function A(){Q({message:"Stai per eliminare un partner. Vuoi confermare l'operazione?",header:"Eliminazione partner",acceptCallback(){e.id&&z(e.id)}})}async function S(a,t){try{r.value=!0,await d.updatePartner(a,t),M("Partner aggiornato con successo")}catch(n){console.error(n)}finally{r.value=!1}}async function R(a){var t;try{r.value=!0,await d.createPartner(a),(t=s.value)!=null&&t.id&&(M("Partner creato con successo"),w.push({name:C.PARTNER_DETTAGLIO,params:{id:s.value.id}}))}catch(n){console.error(n)}finally{r.value=!1}}const b=V(a=>{e.id?S(e.id,a):R(a)});return B(()=>{e.id&&I(e.id)}),O(N.FORM_VALIDATION,u),(a,t)=>{var g;const n=L;return l(),_("div",null,[m("form",{onSubmit:t[2]||(t[2]=(...y)=>i(b)&&i(b)(...y))},[m("div",X,[m("div",Y,[m("h1",null,[k(P(e.id?"Dettaglio partner":"Nuovo partner")+" ",1),e.id?(l(),_("span",Z," - "+P((g=i(s))==null?void 0:g.name),1)):p("",!0)])]),m("div",ee,[o(j,{name:"fade",mode:"out-in"},{default:v(()=>[u.value?e.id?(l(),f(n,{key:1,class:"self-center",size:"large",icon:"pi pi-pen-to-square",rounded:"",variant:"text",onClick:t[1]||(t[1]=y=>u.value=!u.value)})):p("",!0):(l(),_("div",te,[e.id?(l(),f(n,{key:0,severity:"secondary",label:"Annulla",size:"large","icon-pos":"right",style:{"min-width":"100px"},onClick:t[0]||(t[0]=y=>u.value=!0)})):p("",!0),o(n,{label:"Salva",size:"large",type:"submit",loading:r.value,disabled:r.value,"icon-pos":"right",style:{"min-width":"100px"}},null,8,["loading","disabled"])]))]),_:1}),e.id?(l(),f(n,{key:0,class:"self-center",severity:"danger",size:"large",icon:"pi pi-trash",rounded:"",variant:"text",onClick:A})):p("",!0)])]),o(W)],32)])}}}),ce=q(ae,[["__scopeId","data-v-b0414055"]]);export{ce as default};
