import{o as T,F as z,D as S,c as U,a as k,m as c,l as D,_ as B,r as m,p as K,b as _,e as O,f as o,w as d,g as y,q as F,h as R,s as M,v as V,n as x}from"../index22191.js";import{u as N}from"./policy22191.js";import{e as A}from"./helpers22191.js";import{u as E}from"./sidebar22191.js";const L={setup(){T(()=>{r.value=!0,s.value={first:0,rows:w.value.rows,sortField:null,sortOrder:null,filters:u.value},z.register("myfilter",(l,g)=>l===g),t()});const h=N();E();const i=S(),P=U(()=>h.response_policies),n=U(()=>h.policyRoles),C=k(),w=c(),p=c(),u=c({global:{value:null,matchMode:"contains"},full_name:{value:"",matchMode:"contains"},tax_code:{value:"",matchMode:"contains"},company_name:{value:"",matchMode:"contains"},enabled:{value:"",matchMode:"contains"},role:{value:"",matchMode:"contains"}}),r=c(!0),s=c(),f=c(0),b=c([{label:"Attivo",value:"true"},{label:"Disattivo",value:"false"}]),v=c([{label:"Utente",value:"policy"},{label:"Admin",value:"admin"}]),e=c([{label:"My Filter",value:"myfilter"}]);function t(){r.value=!0;const l=new Map;l.set("company_name",u.value.company_name.value),l.set("tax_code",u.value.tax_code.value),l.set("full_name",u.value.full_name.value),l.set("enabled",u.value.enabled.value),l.set("role",u.value.role.value),l.set("page",s.value.page+1),l.set("per_page",s.value.rows),s.value.sortField&&(s.value.sortOrder==1?l.set("sorted_by",s.value.sortField+"_asc"):l.set("sorted_by",s.value.sortField+"_desc")),setTimeout(()=>{a(l)},Math.random()*1e3+250)}const a=async function(l){await h.fetchAllPolicys(l).then(()=>{r.value=!1}).catch(g=>{r.value=!1,A(C,g)})};return{dt:w,responsePolicies:P,filters:u,loading:r,totalRecords:f,lazyParams:s,matchModes:e,policyRoles:n,status:b,roles:v,currentPolicy:p,onPage:l=>{s.value=l,t()},onSort:l=>{s.value=l,t()},onFilter:()=>{s.value.page=0,s.value.filters=u.value,t()},loadLazyData:t,goToDetail:function(l){i.path.includes("estratto-conto")?D.push({name:"partner-detail",params:{id:"234234",policy_id:l}}):D.push({name:"bank-statement-detail",params:{id:"234234",policy_id:l}})}}},components:{}};const I={class:"flex justify-content-between align-items-center"},j={class:"p-input-icon-left w-full mr-3 py-2"},q=y("i",{class:"pi pi-search"},null,-1);function G(h,i,P,n,C,w){const p=m("InputText"),u=m("Button"),r=m("Column"),s=m("Dropdown"),f=m("Badge"),b=m("DataTable"),v=K("tooltip");return _(),O("div",null,[o(b,{value:n.responsePolicies.policies,totalRecords:n.responsePolicies.total,lazy:!0,paginator:!0,rows:50,filters:n.filters,"onUpdate:filters":i[1]||(i[1]=e=>n.filters=e),ref:"dt",dataKey:"id",loading:n.loading,onPage:i[2]||(i[2]=e=>n.onPage(e)),onSort:i[3]||(i[3]=e=>n.onSort(e)),onFilter:i[4]||(i[4]=e=>n.onFilter()),filterDisplay:"row",removableSort:"",stripedRows:""},{header:d(()=>[y("div",I,[y("span",j,[q,o(p,{modelValue:n.filters.global.value,"onUpdate:modelValue":i[0]||(i[0]=e=>n.filters.global.value=e),placeholder:"Ricerca polizza",class:"border-none w-full"},null,8,["modelValue"])]),y("div",null,[F(o(u,{icon:"pi pi-download",text:"",rounded:"","aria-label":"Dowload",size:"large"},null,512),[[v,"Scarica",void 0,{top:!0}]])])])]),empty:d(()=>[R(" Nessuna polizza trovata. ")]),default:d(()=>[o(r,{field:"company_name",header:"N. proposta",filterMatchMode:"contains",ref:"company_name",sortable:!1,showFilterMatchModes:!1,showFilterOperator:!1,showFilterMenu:!1},{filter:d(({filterModel:e,filterCallback:t})=>[o(p,{type:"text",modelValue:e.value,"onUpdate:modelValue":a=>e.value=a,onKeydown:M(a=>t(),["enter"]),class:"p-column-filter",placeholder:"Filtra"},null,8,["modelValue","onUpdate:modelValue","onKeydown"])]),_:1},512),o(r,{field:"full_name",header:"N. finanziamento",filterMatchMode:"contains",ref:"full_name",sortable:!1,showFilterMatchModes:!1,showFilterOperator:!1,showFilterMenu:!1},{filter:d(({filterModel:e,filterCallback:t})=>[o(p,{type:"text",modelValue:e.value,"onUpdate:modelValue":a=>e.value=a,onKeydown:M(a=>t(),["enter"]),class:"p-column-filter",placeholder:"Filtra"},null,8,["modelValue","onUpdate:modelValue","onKeydown"])]),_:1},512),o(r,{field:"tax_code",header:"Codice fiscale",filterMatchMode:"contains",ref:"tax_code",sortable:!1,showFilterMatchModes:!1,showFilterOperator:!1,showFilterMenu:!1},{filter:d(({filterModel:e,filterCallback:t})=>[o(p,{type:"text",modelValue:e.value,"onUpdate:modelValue":a=>e.value=a,onKeydown:M(a=>t(),["enter"]),class:"p-column-filter",placeholder:"Filtra"},null,8,["modelValue","onUpdate:modelValue","onKeydown"])]),_:1},512),o(r,{header:"Compagnia",filterMatchMode:"contains",ref:"role",field:"role",showFilterMatchModes:!1,showFilterOperator:!1,showFilterMenu:!1},{filter:d(({filterModel:e,filterCallback:t})=>[o(s,{modelValue:e.value,"onUpdate:modelValue":a=>e.value=a,options:n.roles,optionValue:"value",optionLabel:"label",onChange:a=>t(),placeholder:"Filtra"},null,8,["modelValue","onUpdate:modelValue","options","onChange"])]),_:1},512),o(r,{header:"Tipologia",filterMatchMode:"contains",ref:"role",field:"role",showFilterMatchModes:!1,showFilterOperator:!1,showFilterMenu:!1},{filter:d(({filterModel:e,filterCallback:t})=>[o(s,{modelValue:e.value,"onUpdate:modelValue":a=>e.value=a,options:n.roles,optionValue:"value",optionLabel:"label",onChange:a=>t(),placeholder:"Filtra"},null,8,["modelValue","onUpdate:modelValue","options","onChange"])]),body:d(({data:e})=>[e.role=="policy"?(_(),V(f,{key:0,value:"Utente",class:x(["px-4",e.role])},null,8,["class"])):e.role=="admin"?(_(),V(f,{key:1,value:"Admin",class:x(["px-4",e.role])},null,8,["class"])):(_(),V(f,{key:2,value:e.role,class:x(["px-4",e.role])},null,8,["value","class"]))]),_:1},512),o(r,{header:"Premio",field:"price"}),o(r,{header:"Data decorrenza",field:"date"}),o(r,{header:"Esito",filterMatchMode:"contains",ref:"enabled",field:"enabled",showFilterMatchModes:!1,showFilterOperator:!1,showFilterMenu:!1},{filter:d(({filterModel:e,filterCallback:t})=>[o(s,{modelValue:e.value,"onUpdate:modelValue":a=>e.value=a,options:n.status,optionValue:"value",optionLabel:"label",onChange:a=>t(),placeholder:"Filtra"},null,8,["modelValue","onUpdate:modelValue","options","onChange"])]),_:1},512),o(r,{header:"",style:{width:"8rem"}},{body:d(({data:e})=>[F(o(u,{type:"button","aria-haspopup":"true","aria-controls":"overlay_menu",class:"mr-3",icon:"pi download-file-icon",text:"",rounded:""},null,512),[[v,"Edit",void 0,{top:!0}]]),F(o(u,{type:"button",onClick:t=>n.goToDetail(e.id),"aria-haspopup":"true","aria-controls":"overlay_menu",class:"mr-0",icon:"pi pi-arrow-right",text:"",rounded:""},null,8,["onClick"]),[[v,"Edit",void 0,{top:!0}]])]),_:1})]),_:1},8,["value","totalRecords","filters","loading"])])}const ee=B(L,[["render",G]]);export{ee as P};
