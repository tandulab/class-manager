import{o as S,F as U,D as C,c as F,a as K,m as u,l as M,_ as D,r as m,p as B,b as R,e as T,f as n,w as p,g as v,q as V,h as N,s as x}from"../index22191.js";import{u as O}from"./policy22191.js";import{e as k}from"./helpers22191.js";import{u as z}from"./sidebar22191.js";import"./toast22191.js";const A={setup(){S(()=>{r.value=!0,a.value={first:0,rows:_.value.rows,sortField:null,sortOrder:null,filters:i.value},U.register("myfilter",(e,g)=>e===g),l()});const f=O();z();const s=C(),y=F(()=>f.response_policies),t=F(()=>f.policyRoles),w=K(),_=u(),c=u(),i=u({global:{value:null,matchMode:"contains"},full_name:{value:"",matchMode:"contains"},tax_code:{value:"",matchMode:"contains"},company_name:{value:"",matchMode:"contains"},enabled:{value:"",matchMode:"contains"},role:{value:"",matchMode:"contains"}}),r=u(!0),a=u(),b=u(0),h=u([{label:"Attivo",value:"true"},{label:"Disattivo",value:"false"}]),o=u([{label:"Utente",value:"policy"},{label:"Admin",value:"admin"}]),d=u([{label:"My Filter",value:"myfilter"}]);function l(){r.value=!0;const e=new Map;e.set("company_name",i.value.company_name.value),e.set("tax_code",i.value.tax_code.value),e.set("full_name",i.value.full_name.value),e.set("enabled",i.value.enabled.value),e.set("role",i.value.role.value),e.set("page",a.value.page+1),e.set("per_page",a.value.rows),a.value.sortField&&(a.value.sortOrder==1?e.set("sorted_by",a.value.sortField+"_asc"):e.set("sorted_by",a.value.sortField+"_desc")),setTimeout(()=>{P(e)},Math.random()*1e3+250)}const P=async function(e){await f.fetchAllPolicys(e).then(()=>{r.value=!1}).catch(g=>{r.value=!1,k(w,g)})};return{dt:_,responsePolicies:y,filters:i,loading:r,totalRecords:b,lazyParams:a,matchModes:d,policyRoles:t,status:h,roles:o,currentPolicy:c,onPage:e=>{a.value=e,l()},onSort:e=>{a.value=e,l()},onFilter:()=>{a.value.page=0,a.value.filters=i.value,l()},loadLazyData:l,goToDetail:function(e){s.path.includes("estratto-conto")?M.push({name:"partner-detail",params:{id:"234234",policy_id:e}}):M.push({name:"bank-statement-detail",params:{id:"234234",policy_id:e}})}}},components:{}};const $={class:"flex justify-content-between align-items-center"},E={class:"p-input-icon-left w-full mr-3 py-2"},I=v("i",{class:"pi pi-search"},null,-1);function L(f,s,y,t,w,_){const c=m("InputText"),i=m("Button"),r=m("Column"),a=m("Dropdown"),b=m("DataTable"),h=B("tooltip");return R(),T("div",null,[n(b,{value:t.responsePolicies.policies,totalRecords:t.responsePolicies.total,lazy:!0,paginator:!0,rows:50,filters:t.filters,"onUpdate:filters":s[1]||(s[1]=o=>t.filters=o),ref:"dt",dataKey:"id",loading:t.loading,onPage:s[2]||(s[2]=o=>t.onPage(o)),onSort:s[3]||(s[3]=o=>t.onSort(o)),onFilter:s[4]||(s[4]=o=>t.onFilter()),filterDisplay:"row",removableSort:"",stripedRows:""},{header:p(()=>[v("div",$,[v("span",E,[I,n(c,{modelValue:t.filters.global.value,"onUpdate:modelValue":s[0]||(s[0]=o=>t.filters.global.value=o),placeholder:"Ricerca file",class:"border-none w-full"},null,8,["modelValue"])]),v("div",null,[V(n(i,{icon:"pi pi-download",text:"",rounded:"","aria-label":"Dowload",size:"large"},null,512),[[h,"Scarica",void 0,{top:!0}]])])])]),empty:p(()=>[N(" Nessun file trovato. ")]),default:p(()=>[n(r,{field:"company_name",header:"Nome file",filterMatchMode:"contains",ref:"company_name",sortable:!1,showFilterMatchModes:!1,showFilterOperator:!1,showFilterMenu:!1},{filter:p(({filterModel:o,filterCallback:d})=>[n(c,{type:"text",modelValue:o.value,"onUpdate:modelValue":l=>o.value=l,onKeydown:x(l=>d(),["enter"]),class:"p-column-filter",placeholder:"Filtra"},null,8,["modelValue","onUpdate:modelValue","onKeydown"])]),_:1},512),n(r,{field:"company_name",header:"Partner",filterMatchMode:"contains",ref:"company_name",sortable:!1,showFilterMatchModes:!1,showFilterOperator:!1,showFilterMenu:!1},{filter:p(({filterModel:o,filterCallback:d})=>[n(c,{type:"text",modelValue:o.value,"onUpdate:modelValue":l=>o.value=l,onKeydown:x(l=>d(),["enter"]),class:"p-column-filter",placeholder:"Filtra"},null,8,["modelValue","onUpdate:modelValue","onKeydown"])]),_:1},512),n(r,{header:"Compagnia",filterMatchMode:"contains",ref:"role",field:"role",showFilterMatchModes:!1,showFilterOperator:!1,showFilterMenu:!1},{filter:p(({filterModel:o,filterCallback:d})=>[n(a,{modelValue:o.value,"onUpdate:modelValue":l=>o.value=l,options:t.roles,optionValue:"value",optionLabel:"label",onChange:l=>d(),placeholder:"Filtra"},null,8,["modelValue","onUpdate:modelValue","options","onChange"])]),_:1},512),n(r,{header:"Tipo",field:"price"}),n(r,{header:"Data inserimento",field:"date"}),n(r,{header:"",style:{width:"5rem"}},{body:p(({data:o})=>[V(n(i,{type:"button","aria-haspopup":"true","aria-controls":"overlay_menu",class:"mr-0",icon:"pi pi-trash",text:"",rounded:""},null,512),[[h,"Edit",void 0,{top:!0}]])]),_:1})]),_:1},8,["value","totalRecords","filters","loading"])])}const j=D(A,[["render",L]]),q={setup(){return{}},components:{RepositoryTable:j}},G=v("h1",null,"Repository",-1);function H(f,s,y,t,w,_){const c=m("RepositoryTable");return R(),T("div",null,[G,n(c)])}const ae=D(q,[["render",H]]);export{ae as default};
