import{V as C,s as E,a as J,b as K,c as z,d as G}from"./ValidateDropdown49648.js";import{V as h,s as P,c as H,a as g}from"./ValidateInputText49648.js";import{I as T,C as R}from"./CustomCardForm49648.js";import{d as w,l as A,a as d,c as U,w as a,b as D,e as t,i as s,s as O,J as Q,o as S,f,v as q,k as V,m as W,r as M,p as k,q as X,t as y,F as Y,_ as Z}from"../index49648.js";import{_ as ee,u as te}from"./RoleCard.vue_vue_type_script_setup_true_lang49648.js";import{u as ae}from"./partner49648.js";import{u as se}from"./useRole49648.js";import{_ as oe}from"./AppBack.vue_vue_type_script_setup_true_lang49648.js";import"./index496482.js";import"./index49648.js";const re=w({__name:"UserDataCard",setup(b){const e=A(T.FORM_VALIDATION);return(o,l)=>{const n=P;return d(),U(R,null,{title:a(()=>l[0]||(l[0]=[D("Dati")])),content:a(()=>[t(n,{class:"fluid-form-grid sm:grid-cols-2"},{default:a(()=>[t(h,{id:"first_name",name:"first_name",type:"text",label:"Nome*",detailMode:s(e)},null,8,["detailMode"]),t(h,{id:"last_name",name:"last_name",type:"text",label:"Cognome*",detailMode:s(e)},null,8,["detailMode"]),t(h,{class:"sm:col-span-2",id:"email",name:"email",type:"email",label:"Email*",detailMode:s(e)},null,8,["detailMode"])]),_:1})]),_:1})}}}),le={style:{"padding-block":"0.625rem","padding-inline":"0.25rem"}},ne=w({__name:"UserRoleCard",setup(b){const e=ae(),{allPartners:o}=O(e),{roles:l,isAdmin:n}=se(),u=A(T.FORM_VALIDATION),{value:I}=Q("role");async function i(){try{await e.fetchPartners()}catch(r){console.error(r)}}return S(()=>{n.value&&i()}),(r,m)=>{const _=P;return d(),U(R,null,{title:a(()=>m[0]||(m[0]=[D("Ruolo")])),content:a(()=>[t(_,{class:"fluid-form-grid sm:grid-cols-2"},{default:a(()=>[t(C,{id:"role",name:"role",label:"Ruolo","option-value":"value","option-label":"label",options:s(l),detailMode:s(u)},{detail:a(({data:v})=>[f("div",le,[v.field?(d(),U(ee,{key:0,class:"max-w-[100px]",role:v.field},null,8,["role"])):q("",!0)])]),_:1},8,["options","detailMode"]),t(C,{id:"partner_id",name:"partner_id",label:"Partner","option-value":"id","option-label":"name",options:s(o),detailMode:s(u),disabled:s(I)=="admin"||!s(n)},null,8,["options","detailMode","disabled"])]),_:1})]),_:1})}}}),ie={class:"flex flex-col sm:flex-row gap-4"},ce=w({__name:"UserDataTab",setup(b){return(e,o)=>(d(),V("div",ie,[t(re,{class:"sm:w-1/2"}),t(ne,{class:"sm:w-1/2"})]))}}),de={class:"flex flex-col sm:flex-row items-start sm:items-center justify-between mb-4"},ue={class:"flex items-center gap-4"},me={key:0},_e=w({__name:"UserDetailView",props:{id:{},partnerId:{}},setup(b){const e=b,o=te(),{user:l}=O(o),{resetForm:n}=W({validationSchema:H({email:g().email("L'email non è valida").required("Email è obbligatoria"),first_name:g().required("Nome è obbligatorio"),last_name:g().required("Cognome è obbligatorio"),partner_id:g().nullable().when("role",{is:c=>c==="partner",then:c=>c.required("Partner obbligatorio")})}),initialValues:{role:"partner"}}),u=M(!1),I=M(!!e.id),i=M(""),r=M(""),m=k(()=>!e.id),_=k(()=>o.currentUser);async function v(c){var p,x;try{u.value=!0,await o.fetchUserDetail(c),n({values:{...l.value}}),e.partnerId&&(r.value="Utenti partner "+((x=(p=_.value)==null?void 0:p.partner)==null?void 0:x.name),i.value=`/utenti/partner/${e.partnerId}`)}catch($){console.error($)}finally{u.value=!1}}return S(()=>{e.id&&v(e.id),e.partnerId?(r.value="Utenti Partner",i.value="/utenti/partner/"+e.partnerId):(r.value="Utenti",i.value="/utenti")}),X(T.FORM_VALIDATION,I),(c,p)=>{var F,N;const x=J,$=K,L=z,B=G,j=E;return d(),V(Y,null,[t(oe,{title:r.value,url:i.value},null,8,["title","url"]),f("form",null,[f("div",de,[f("div",ue,[f("h3",null,[D(y(m.value?"Nuovo utente":"Dettaglio utente")+" ",1),m.value?q("",!0):(d(),V("span",me," - "+y((F=_.value)==null?void 0:F.first_name)+" "+y((N=_.value)==null?void 0:N.last_name),1))])])]),t(j,{scrollable:"",value:"0"},{default:a(()=>[t($,null,{default:a(()=>[t(x,{value:"0"},{default:a(()=>p[0]||(p[0]=[D("Dati utente")])),_:1})]),_:1}),t(B,null,{default:a(()=>[t(L,{value:"0"},{default:a(()=>[t(ce)]),_:1})]),_:1})]),_:1})])],64)}}}),$e=Z(_e,[["__scopeId","data-v-bfbd3f9f"]]);export{$e as default};
