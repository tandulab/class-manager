import{V as C,s as K,a as z,b as G,c as H,d as J}from"./ValidateDropdown81571.js";import{d as D,l as P,a as u,c as U,w as a,b as M,e as t,i as s,s as R,a2 as Q,o as A,f as _,v as S,k as V,m as W,r as x,p as k,q as X,t as $,F as Y,_ as Z}from"../index81571.js";import{V as y,s as O,c as ee,a as g}from"./ValidateInputText81571.js";import{I as T,C as q}from"./CustomCardForm81571.js";import{_ as te,u as ae}from"./RoleCard.vue_vue_type_script_setup_true_lang81571.js";import{u as se}from"./partner81571.js";import{u as le}from"./useRole81571.js";import{_ as oe}from"./AppBack.vue_vue_type_script_setup_true_lang81571.js";import"./index815712.js";import"./index81571.js";const re=D({__name:"UserDataCard",setup(p){const e=P(T.FORM_VALIDATION);return(l,n)=>{const i=O;return u(),U(q,null,{title:a(()=>n[0]||(n[0]=[M("Dati")])),content:a(()=>[t(i,{class:"fluid-form-grid sm:grid-cols-2"},{default:a(()=>[t(y,{id:"first_name",name:"first_name",type:"text",label:"Nome*",detailMode:s(e)},null,8,["detailMode"]),t(y,{id:"last_name",name:"last_name",type:"text",label:"Cognome*",detailMode:s(e)},null,8,["detailMode"]),t(y,{class:"sm:col-span-2",id:"email",name:"email",type:"email",label:"Email*",detailMode:s(e)},null,8,["detailMode"])]),_:1})]),_:1})}}}),ne={style:{"padding-block":"0.625rem","padding-inline":"0.25rem"}},ie=D({__name:"UserRoleCard",setup(p){const e=se(),{allPartners:l}=R(e),{roles:n,isAdmin:i}=le(),h=P(T.FORM_VALIDATION),{value:f}=Q("role");async function w(){try{await e.fetchPartners()}catch(o){console.error(o)}}return A(()=>{i.value&&w()}),(o,r)=>{const b=O;return u(),U(q,null,{title:a(()=>r[0]||(r[0]=[M("Ruolo")])),content:a(()=>[t(b,{class:"fluid-form-grid sm:grid-cols-2"},{default:a(()=>[t(C,{id:"role",name:"role",label:"Ruolo","option-value":"value","option-label":"label",options:s(n),detailMode:s(h)},{detail:a(({data:c})=>[_("div",ne,[c.field?(u(),U(te,{key:0,class:"max-w-[100px]",role:c.field},null,8,["role"])):S("",!0)])]),_:1},8,["options","detailMode"]),t(C,{id:"partner_id",name:"partner_id",label:"Partner","option-value":"id","option-label":"name",options:s(l),detailMode:s(h),disabled:s(f)=="admin"||!s(i)},null,8,["options","detailMode","disabled"])]),_:1})]),_:1})}}}),ce={class:"flex flex-col sm:flex-row gap-4"},de=D({__name:"UserDataTab",setup(p){return(e,l)=>(u(),V("div",ce,[t(re,{class:"sm:w-1/2"}),t(ie,{class:"sm:w-1/2"})]))}}),ue={class:"flex flex-col sm:flex-row items-start sm:items-center justify-between mb-4"},me={class:"flex items-center gap-4"},_e={key:0},pe=D({__name:"UserDetailView",props:{id:{},partnerId:{}},setup(p){const e=p,l=ae(),{user:n}=R(l),{resetForm:i,handleSubmit:h}=W({validationSchema:ee({email:g().email("L'email non è valida").required("Email è obbligatoria"),first_name:g().required("Nome è obbligatorio"),last_name:g().required("Cognome è obbligatorio"),partner_id:g().nullable().when("role",{is:d=>d==="partner",then:d=>d.required("Partner obbligatorio")})}),initialValues:{role:"partner"}}),f=x(!1),w=x(!!e.id),o=x(""),r=x(""),b=k(()=>!e.id),c=k(()=>l.currentUser);async function L(d){var m,v;try{f.value=!0,await l.fetchUserDetail(d),i({values:{...n.value}}),e.partnerId&&(r.value="Utenti partner "+((v=(m=c.value)==null?void 0:m.partner)==null?void 0:v.name),o.value=`/utenti/partner/${e.partnerId}`)}catch(I){console.error(I)}finally{f.value=!1}}return A(()=>{e.id&&L(e.id),e.partnerId?(r.value="Utenti Partner",o.value="/utenti/partner/"+e.partnerId):(r.value="Utenti",o.value="/utenti")}),X(T.FORM_VALIDATION,w),(d,m)=>{var F,N;const v=z,I=G,B=H,j=J,E=K;return u(),V(Y,null,[t(oe,{title:r.value,url:o.value},null,8,["title","url"]),_("form",null,[_("div",ue,[_("div",me,[_("h3",null,[M($(b.value?"Nuovo utente":"Dettaglio utente")+" ",1),b.value?S("",!0):(u(),V("span",_e," - "+$((F=c.value)==null?void 0:F.first_name)+" "+$((N=c.value)==null?void 0:N.last_name),1))])])]),t(E,{scrollable:"",value:"0"},{default:a(()=>[t(I,null,{default:a(()=>[t(v,{value:"0"},{default:a(()=>m[0]||(m[0]=[M("Dati utente")])),_:1})]),_:1}),t(j,null,{default:a(()=>[t(B,{value:"0"},{default:a(()=>[t(de)]),_:1})]),_:1})]),_:1})])],64)}}}),$e=Z(pe,[["__scopeId","data-v-ee11cb8e"]]);export{$e as default};
