import{o as K,F as R,c as k,a as O,m as c,_ as C,r as f,p as A,b as p,e as _,f as a,w as d,g as b,q as D,h as N,s as V,v as S,n as x,i as $}from"../index64973.js";import{u as T}from"./user64973.js";import{e as z}from"./helpers64973.js";import{u as B}from"./sidebar64973.js";import"./toast64973.js";const P={setup(){K(()=>{u.value=!0,r.value={first:0,rows:y.value.rows,sortField:null,sortOrder:null,filters:i.value},R.register("myfilter",(l,M)=>l===M),s()});const v=T(),t=B(),h=k(()=>v.responseUsers),o=k(()=>v.userRoles),U=O(),y=c(),m=c(),i=c({global:{value:null,matchMode:"contains"},full_name:{value:"",matchMode:"contains"},email:{value:"",matchMode:"contains"},company_name:{value:"",matchMode:"contains"},enabled:{value:"",matchMode:"contains"},role:{value:"",matchMode:"contains"}}),u=c(!0),r=c(),w=c(0),F=c([{label:"Attivo",value:"true"},{label:"Disattivo",value:"false"}]),g=c([{label:"Utente",value:"user"},{label:"Admin",value:"admin"}]),e=c([{label:"My Filter",value:"myfilter"}]);function s(){u.value=!0;const l=new Map;l.set("company_name",i.value.company_name.value),l.set("email",i.value.email.value),l.set("full_name",i.value.full_name.value),l.set("enabled",i.value.enabled.value),l.set("role",i.value.role.value),l.set("page",r.value.page+1),l.set("per_page",r.value.rows),r.value.sortField&&(r.value.sortOrder==1?l.set("sorted_by",r.value.sortField+"_asc"):l.set("sorted_by",r.value.sortField+"_desc")),setTimeout(()=>{n(l)},Math.random()*1e3+250)}const n=async function(l){await v.fetchAllUsers(l).then(()=>{u.value=!1}).catch(M=>{u.value=!1,z(U,M)})};return{dt:y,responseUsers:h,filters:i,loading:u,totalRecords:w,lazyParams:r,matchModes:e,userRoles:o,status:F,roles:g,currentUser:m,onPage:l=>{r.value=l,s()},onSort:l=>{r.value=l,s()},onFilter:()=>{r.value.page=0,r.value.filters=i.value,s()},showSidebar:function(l){t.setDetailType("user",!1,"Dettaglio utente",l.id),t.updateSidebar(!0)},loadLazyData:s}},components:{}};const E={class:"flex justify-content-between align-items-center"},L={class:"p-input-icon-left w-full mr-3 py-2"},j=b("i",{class:"pi pi-search"},null,-1),I={key:0,class:"pi pi-check font-semibold"},q={key:1,class:"pi pi-times text-red-600 font-semibold"};function G(v,t,h,o,U,y){const m=f("InputText"),i=f("Button"),u=f("Column"),r=f("Dropdown"),w=f("Badge"),F=f("DataTable"),g=A("tooltip");return p(),_("div",null,[a(F,{value:o.responseUsers.users,totalRecords:o.responseUsers.total,lazy:!0,paginator:!0,rows:30,filters:o.filters,"onUpdate:filters":t[1]||(t[1]=e=>o.filters=e),ref:"dt",dataKey:"id",loading:o.loading,onPage:t[2]||(t[2]=e=>o.onPage(e)),onSort:t[3]||(t[3]=e=>o.onSort(e)),onFilter:t[4]||(t[4]=e=>o.onFilter()),filterDisplay:"row",removableSort:"",stripedRows:""},{header:d(()=>[b("div",E,[b("span",L,[j,a(m,{modelValue:o.filters.global.value,"onUpdate:modelValue":t[0]||(t[0]=e=>o.filters.global.value=e),placeholder:"Ricerca utente",class:"border-none w-full"},null,8,["modelValue"])]),b("div",null,[D(a(i,{icon:"pi pi-download",text:"",rounded:"","aria-label":"Dowload",size:"large"},null,512),[[g,"Scarica",void 0,{top:!0}]])])])]),empty:d(()=>[N(" Nessun utente trovato. ")]),default:d(()=>[a(u,{field:"company_name",header:"Nome",filterMatchMode:"contains",ref:"company_name",sortable:!1,showFilterMatchModes:!1,showFilterOperator:!1,showFilterMenu:!1},{filter:d(({filterModel:e,filterCallback:s})=>[a(m,{type:"text",modelValue:e.value,"onUpdate:modelValue":n=>e.value=n,onKeydown:V(n=>s(),["enter"]),class:"p-column-filter",placeholder:"Filtra per nome"},null,8,["modelValue","onUpdate:modelValue","onKeydown"])]),_:1},512),a(u,{field:"full_name",header:"Cognome",filterMatchMode:"contains",ref:"full_name",sortable:!1,showFilterMatchModes:!1,showFilterOperator:!1,showFilterMenu:!1},{filter:d(({filterModel:e,filterCallback:s})=>[a(m,{type:"text",modelValue:e.value,"onUpdate:modelValue":n=>e.value=n,onKeydown:V(n=>s(),["enter"]),class:"p-column-filter",placeholder:"Filtra per nome cognome"},null,8,["modelValue","onUpdate:modelValue","onKeydown"])]),_:1},512),a(u,{field:"email",header:"Email",filterMatchMode:"contains",ref:"email",sortable:!1,showFilterMatchModes:!1,showFilterOperator:!1,showFilterMenu:!1},{filter:d(({filterModel:e,filterCallback:s})=>[a(m,{type:"text",modelValue:e.value,"onUpdate:modelValue":n=>e.value=n,onKeydown:V(n=>s(),["enter"]),class:"p-column-filter",placeholder:"Filtra per email"},null,8,["modelValue","onUpdate:modelValue","onKeydown"])]),_:1},512),a(u,{header:"Ruolo",filterMatchMode:"contains",ref:"role",field:"role",showFilterMatchModes:!1,showFilterOperator:!1,showFilterMenu:!1},{filter:d(({filterModel:e,filterCallback:s})=>[a(r,{modelValue:e.value,"onUpdate:modelValue":n=>e.value=n,options:o.roles,optionValue:"value",optionLabel:"label",onChange:n=>s(),placeholder:"Filtra per ruolo"},null,8,["modelValue","onUpdate:modelValue","options","onChange"])]),body:d(({data:e})=>[e.role=="user"?(p(),S(w,{key:0,value:"Utente",class:x(["px-4",e.role])},null,8,["class"])):e.role=="admin"?(p(),S(w,{key:1,value:"Admin",class:x(["px-4",e.role])},null,8,["class"])):(p(),S(w,{key:2,value:e.role,class:x(["px-4",e.role])},null,8,["value","class"]))]),_:1},512),a(u,{header:"Stato",filterMatchMode:"contains",ref:"enabled",field:"enabled",showFilterMatchModes:!1,showFilterOperator:!1,showFilterMenu:!1},{filter:d(({filterModel:e,filterCallback:s})=>[a(r,{modelValue:e.value,"onUpdate:modelValue":n=>e.value=n,options:o.status,optionValue:"value",optionLabel:"label",onChange:n=>s(),placeholder:"Filtra per stato"},null,8,["modelValue","onUpdate:modelValue","options","onChange"])]),body:d(({data:e})=>[e.enabled?(p(),_("i",I)):(p(),_("i",q))]),_:1},512),a(u,{header:"",style:{width:"4rem"}},{body:d(({data:e})=>[D(a(i,{type:"button",onClick:s=>o.showSidebar(e),"aria-haspopup":"true","aria-controls":"overlay_menu",class:"mr-3",icon:"pi pi-arrow-right",text:"",rounded:""},null,8,["onClick"]),[[g,"Edit",void 0,{top:!0}]])]),_:1})]),_:1},8,["value","totalRecords","filters","loading"])])}const H=C(P,[["render",G]]),J={setup(){const v=T(),t=k(()=>v.getTotalUsers),h=B();return{totalUser:t,showSidebar:function(){h.setDetailType("user",!0,"Nuovo utente",null),h.updateSidebar(!0),h.setShowDetail(!0)}}},components:{UsersTable:H}},Q={class:"flex justify-content-between align-items-center"},W={class:""},X={key:0},Y={key:1};function Z(v,t,h,o,U,y){const m=f("Button"),i=f("UsersTable");return p(),_("div",null,[b("div",Q,[b("h1",W,[o.totalUser==1?(p(),_("span",X," 1 Utente")):(p(),_("span",Y,$(o.totalUser)+" Utenti",1))]),a(m,{label:"Aggiungi utente",onClick:t[0]||(t[0]=u=>o.showSidebar()),class:"mb-3",rounded:"",outlined:""})]),a(i)])}const ue=C(J,[["render",Z]]);export{ue as default};
